<!DOCTYPE html>

<html lang="en">

<head>
    <title>note by github</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=0">

    <link rel="stylesheet" href="css/toastr.min.css">
    <link rel="stylesheet" href="js/zTree/css/zTreeStyle.css">
    <style>
        body {
            /* width: 500px; */
            /* height: 400px; */
            width: 100%;
            height: 100vh;
        }

        label {
            display: inline-block;
            width: 100px;
        }

        #titleId {
            color: red;
        }

        h2 {
            color: green;
            width: 20%;
            text-align: center;
        }

        .dirCls {
            color: blue;
            text-decoration: underline;
        }

        textarea {
            height: 90%;
            width: 90%;
        }
    </style>
</head>

<body>

    <h1>NOTE</h1>

    <div style="display: flex; flex-direction: row;">
        <h2 id="h2id">token未设置</h2>
        <h2>owner未设置</h2>
        <h2>repo未设置</h2>
        <h2>未连接</h2>
    </div>
    

    <h3 id="titleId">+</h3>

    <div>
        <label>token：</label>
        <input type="text" id="token" />
        <button id="updateToken">设置token</button>
    </div>

    <div>
        <label>owner：</label>
        <input type="text" id="owner" />
        <button id="updateOwner">设置owner</button>
    </div>

    <div>
        <label>repo：</label>
        <input type="text" id="repo" />
        <button id="updateRepo">设置repo</button>
    </div>

    <div>
        <label>filePath：</label>
        <input type="text" id="filePath" />
        <button id="updateFilePath">设置filePath</button>
        <!-- <button id="showFilePath">获取filePath</button> -->
        <button id="getFileBtn">获取文件列表</button>
    </div>


    <div style="height: 40%;">
        <!-- <textarea id="content" rows="10" cols="150"></textarea> -->
        <textarea id="content"></textarea>
    </div>

    <div>
        <button id="pullBtn">pull</button>
        <button id="pushBtn">push</button>

    </div>

    <div>
        <ul id="fileList">

        </ul>
    </div>

    <div>
        <ul id="gitTree" class="ztree"></ul>
    </div>

    <!-- <script type="text/javascript" id="clstr_globe" src="//clustrmaps.com/globe.js?d=UVgWJMK1D-VEVRYx-LTQ-VCk3a54XOGoJaKs3h5hru8"></script> -->

    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/toastr.min.js"></script>

    <script type="text/javascript" src="js/zTree/js/jquery.ztree.all.min.js"></script>

    <script type="text/javascript" src="js/octokat.js"></script>

    <script type="text/javascript" src="js/utils.js"></script>
    <script type="text/javascript" src="js/main.js"></script>

    <script>
        toastr.options.positionClass = 'toast-top-center'


        var zTreeObj;
        // zTree 的参数配置，深入使用请参考 API 文档（setting 配置详解）
        var setting = {
            data: {
                key: {
                    name: "name"
                }
            },
            view: {
                showLine: false,
                addDiyDom: addDiyDom
            },
            edit: {
                enable: true,
                showRemoveBtn: false,
                showRenameBtn: false
            },
            // callback: {
            //     onClick: zTreeOnClick,
            //     onRightClick: OnRightClick,
            //     onDrag: onDrag,
            //     onDrop: onDrop,
            // }
        };

        function initTree(zNodes) {
            zTreeObj = $.fn.zTree.init($("#gitTree"), setting, zNodes);
            // todo
            // if (curId) {
            //     var treeNode = zTreeObj.getNodeByParam('id', curId, null);
            //     var parentTreeNode = zTreeObj.getNodeByParam('id', treeNode.pid, null);
            //     // 展开父节点
            //     zTreeObj.expandNode(parentTreeNode)
            //     // 选中当前节点
            //     zTreeObj.selectNode(treeNode)
            //     // 触发当前节点的点击事件
            //     zTreeObj.setting.callback.onClick(null, curId, treeNode)
            // } else {
            //     // todo
            //     var treeNode = zTreeObj.getNodeByParam('id', zNodes[0].id, null);
            //     // 展开
            //     zTreeObj.expandNode(treeNode)
            // }
        }

        function addDiyDom(treeId, treeNode) {
            console.log('treeId=', treeId)
            console.log('treeNode=', treeNode)
            var aObj = $("#" + treeNode.tId + "_a");
            // if ($("#diyBtn_" + treeNode.id).length > 0) return;
            var editStr = "<span id='diyBtn_space_" + treeNode.id + "' > </span>"
                + "<button type='button' class='diyBtn1' id='diyBtn_" + treeNode.id
                + "' title='" + treeNode.name + "' onfocus='this.blur();'>123</button>";
            aObj.append(editStr);
            // var btn = $("#diyBtn_" + treeNode.id);
            // if (btn) btn.bind("click", function () { alert("diy Button for " + treeNode.name); });
        }


        var data = [
            {
                "id": "a",
                "pid": 0,
                "name": 'a',
                "children": [
                    {
                        "id": "a/b",
                        "pid": "a",
                        "name": 'a/b'
                    }
                ]
            },
            {
                "id": "readme.md",
                "pid": 0,
                "name": 'readme.md'
            }
        ]

        initTree(data)
    </script>
</body>

</html>